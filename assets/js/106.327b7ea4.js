(window.webpackJsonp=window.webpackJsonp||[]).push([[106],{409:function(i,v,s){"use strict";s.r(v);var _=s(22),o=Object(_.a)({},(function(){var i=this,v=i.$createElement,s=i._self._c||v;return s("ContentSlotsDistributor",{attrs:{"slot-key":i.$parent.slotKey}},[s("h1",{attrs:{id:"越权自动化测试方案"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#越权自动化测试方案"}},[i._v("#")]),i._v(" 越权自动化测试方案")]),i._v(" "),s("p",[s("img",{attrs:{src:"/websec/programme/passiveproxy.jpg",alt:""}})]),i._v(" "),s("h2",{attrs:{id:"方案1-纯被动代理模式"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#方案1-纯被动代理模式"}},[i._v("#")]),i._v(" 方案1:纯被动代理模式")]),i._v(" "),s("ol",[s("li",[i._v("测试人员将bp代理指向passiveproxy,或者浏览器代理设置为passiveproxy")]),i._v(" "),s("li",[i._v("passiveproxy实现2个功能\n"),s("ol",[s("li",[i._v("监听用户的请求数据，将cookie信息缓存到redis服务器")]),i._v(" "),s("li",[i._v("每隔10s将缓存的cookie信息主动请求服务器，判断cookie有效性,失效移除redis服务器")])])]),i._v(" "),s("li",[i._v("发送越权测试请求报文,发包程序将每个请求批量的替换为redis中缓存的cookie请求发送数据包")]),i._v(" "),s("li",[i._v("通过响应的数据判断是否存在越权")])]),i._v(" "),s("h2",{attrs:{id:"方案2-被动代理模式-iast辅助"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#方案2-被动代理模式-iast辅助"}},[i._v("#")]),i._v(" 方案2:被动代理模式+IAST辅助")]),i._v(" "),s("ol",[s("li",[i._v("测试人员将bp代理指向passiveproxy,或者浏览器代理设置为passiveproxy")]),i._v(" "),s("li",[i._v("passiveproxy实现2个功能\n"),s("ol",[s("li",[i._v("监听用户的请求数据，将cookie信息缓存到redis服务器")]),i._v(" "),s("li",[i._v("每隔10s将缓存的cookie信息主动请求服务器，判断cookie有效性,失效移除redis服务器")])])]),i._v(" "),s("li",[i._v("发送越权测试请求报文,发包程序将每个请求批量的替换为redis中缓存的cookie请求发送数据包（1,2,3步同方案1）")]),i._v(" "),s("li",[i._v("引入IAST插桩辅助完成:\n"),s("ol",[s("li",[i._v("通过IAST获取执行SQL的语句")]),i._v(" "),s("li",[i._v("IASThook语句的分类:\n"),s("ol",[s("li",[i._v("请求报文的api接口只hook到一条执行语句 --- "),s("strong",[i._v("不存在越权")])]),i._v(" "),s("li",[i._v("请求的报文的api接口hook到>=2条执行语句:\n"),s("ol",[s("li",[i._v("语句完全一致 --- "),s("strong",[i._v("存在越权")])]),i._v(" "),s("li",[i._v("语句不一致 --- "),s("strong",[i._v("不存在越权")])])])])])])])])]),i._v(" "),s("h2",{attrs:{id:"总结"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#总结"}},[i._v("#")]),i._v(" 总结")]),i._v(" "),s("ul",[s("li",[i._v("方案1模式：\n"),s("ul",[s("li",[i._v("优点：简单粗暴,实现简单,无脑发包,根据响应结果判断")]),i._v(" "),s("li",[i._v("缺点：不支持删除/修改操作判断,误判多")])])]),i._v(" "),s("li",[i._v("方案2模式：\n"),s("ul",[s("li",[i._v("缺点：需IAST辅助判断,成本较高,适合IAST已推广部署的场景")]),i._v(" "),s("li",[i._v("优点：增/删/改/查 均支持,但是如果增/改模式中引入时间戳参数,可能存在发现不了的问题")])])])])])}),[],!1,null,null,null);v.default=o.exports}}]);