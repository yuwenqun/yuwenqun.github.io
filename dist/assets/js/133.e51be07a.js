(window.webpackJsonp=window.webpackJsonp||[]).push([[133],{436:function(t,e,n){"use strict";n.r(e);var a=n(22),s=Object(a.a)({},(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[n("h2",{attrs:{id:"记录日志"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#记录日志"}},[t._v("#")]),t._v(" 记录日志")]),t._v(" "),n("h2",{attrs:{id:"自定义添加字段"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#自定义添加字段"}},[t._v("#")]),t._v(" 自定义添加字段")]),t._v(" "),n("h2",{attrs:{id:"自定义日志路径"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#自定义日志路径"}},[t._v("#")]),t._v(" 自定义日志路径")]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v("module SSHTTP;\nexport {\nredef enum Log::ID += { LOG };\nredef record HTTP::Info += {  //从http中添加字段，需要明确是哪个模块中的数据(HTTP)\n          req_headers:  string &log &optional;\n          resp_headers:  string &log &optional;\n           req_data: string &log &optional;\n           resp_data: string &log &optional;\n           resp_version: string &log &optional;\n           resp_code: count &log &optional;\n           resp_reason: string &log &optional;\n           req_method: string &log &optional;\n           req_version : string &log &optional;\n           req_original_URI : string &log &optional;\n           req_unescaped_URI : string &log &optional;\n           isNeedData: string &log &optional;\n\t};\n\n\n}\n")])])]),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v('event zeek_init() &priority=5\n\t{\n\tLog::create_stream(SSHTTP::LOG, [$columns=HTTP::Info, $path="xhttp"]); //默认是当前的路径下，日志文件名为xhttp\n\t}\n')])])]),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v("event http_message_done(c: connection, is_orig: bool, stat: http_message_stat) &priority=6{\n\tif ( ! is_orig )\n\t\t{\n\t\t# If the response was an informational 1xx, we're still expecting\n\t\t# the real response later, so we'll continue using the same record.\n\t\t\tif(c$http$isNeedData == \"T\"){\n\t\t\t\tLog::write(SSHTTP::LOG, c$http);\n\t\t\t\tdelete c$http_state$pending[c$http_state$current_response];\n\t\t\t  }\n\t\t}\n}\n")])])]),n("h2",{attrs:{id:"写入es模块"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#写入es模块"}},[t._v("#")]),t._v(" 写入ES模块")])])}),[],!1,null,null,null);e.default=s.exports}}]);